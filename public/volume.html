<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-59986301-2"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());

			gtag('config', 'UA-59986301-2');
		</script>

		<script src="/__/firebase/7.19.0/firebase-app.js"></script>
		<!-- include only the Firebase features as you need -->
		<script src="/__/firebase/7.19.0/firebase-auth.js"></script>
		<script src="/__/firebase/7.19.0/firebase-database.js"></script>
		<script src="/__/firebase/7.19.0/firebase-messaging.js"></script>
		<script src="/__/firebase/7.19.0/firebase-storage.js"></script>
		<script src="/__/firebase/7.19.0/firebase-firestore.js"></script>


		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>The Truths We Hold by Kamala Harris</title>
		<meta name="description" content="Jonathan's highlights and notes from {book}.">

		<link rel="stylesheet" type="text/css" href="/index.css">
		<link rel="SHORTCUT ICON" href="/favicon.png">
	</head>

	<body>
		<div id="root">
			<nav class="c-nav"><a href="/">← Browse all reads</a></nav>

			<main class="l-container l-container--highlights">

				<header class="c-volume-header">
					<figure class="c-cover">
						<img srcset="https://sawyer-highlights.imgix.net/volume/covers/kamala?w=250&amp;h=400&amp;fit=crop&amp;q=50&amp;auto=format&amp;dpr=1 1x, https://sawyer-highlights.imgix.net/volume/covers/kamala?w=250&amp;h=400&amp;fit=crop&amp;q=50&amp;auto=format&amp;dpr=2 2x" src="https://sawyer-highlights.imgix.net/volume/covers/kamala?w=250&amp;h=400&amp;fit=crop&amp;q=50&amp;auto=format" alt="The Truths We Hold">
					</figure>
					<h1 class="u-antialiased">The Truths We Hold</h1>
					<h2 class="u-antialiased">An American Journey</h2>
					<p class="c-volume-header__authors u-family-mono">Kamala Harris</p>
				</header>

				<article class="c-highlight">
					<blockquote class="c-highlight__body">
						<p><span>
							First, my name is pronounced “comma-la,” like the punctuation mark. It means “lotus flower,” which is a symbol of significance in Indian culture. A lotus grows underwater, its flower rising above the surface while its roots are planted firmly in the river bottom.
						</span></p>
					</blockquote>
				</article>

			</main>

		</div>
	</body>

	<script src="./FirebaseConfig.js"></script>	

	<script>

	let xhttp = new XMLHttpRequest();

	function renderHeader(volume) {
		let id = volume.book.id;
		let root = document.getElementById('root');
		let main = root.getElementsByTagName('main')[0];
		let header = document.createElement('HEADER');
		let h1 = document.createElement('H1');
		let h2 = document.createElement('H2');
		let p = document.createElement('P');
		let figure = document.createElement('FIGURE');
		let img = document.createElement('IMG');
		let coverName = 'Default';

		xhttp.open("GET", `covers/${id}.jpg`, false);
		xhttp.send();

		if (xhttp.status == 200) {
			coverName = id;
		} else {
			coverName = 'Default';
		}

		img.src = `./covers/${coverName}.jpg`;
		h1.innerHTML = volume.book.title;
		h2.innerHTML = '';
		p.innerHTML = volume.book.authors[0];

		figure.classList.add("c-cover");
		header.classList.add("c-volume-header");
		h1.classList.add("u-antialiased");
		h2.classList.add("u-antialiased");
		p.classList.add("c-volume-header__authors")
		p.classList.add("u-family-mono")

		figure.appendChild(img);
		header.appendChild(figure);
		header.appendChild(h1);
		header.appendChild(h2);
		header.appendChild(p);
		main.appendChild(header);

		console.log('Rendering Header.....')
		console.log('DONE')
	}

	function renderHighlights(book) {
		console.log('Rendering Highlights.....')
		console.log('DONE')
	}

	async function getVolume() {

		const id = window.location.href.split('=')[1]
		const bookRef = firebase.firestore().collection("volumes").doc(id);
		const doc = await bookRef.get();

		if (!doc.exists) {
			console.log('No such document!');
		} else {
			console.log('Document data:', doc.data());
			renderHeader(doc.data())
			renderHighlights(doc.data())
		}
	}

	getVolume();

	</script>

</html>
